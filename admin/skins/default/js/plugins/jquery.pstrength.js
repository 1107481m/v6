window.digitalspaghetti=window.digitalspaghetti||{};digitalspaghetti.password={defaults:{displayMinChar:true,minChar:8,minCharText:"You must enter a minimum of %d characters",colors:["#f00","#c06","#f60","#3c0","#3f0"],scores:[20,30,43,50],verdicts:["Weak","Normal","Medium","Strong","Very Strong"],raisePower:1.4,debug:false},ruleScores:{length:0,lowercase:1,uppercase:3,one_number:3,three_numbers:5,one_special_char:3,two_special_char:5,upper_lower_combo:2,letter_number_combo:2,letter_number_char_combo:2},rules:{length:true,lowercase:true,uppercase:true,one_number:true,three_numbers:true,one_special_char:true,two_special_char:true,upper_lower_combo:true,letter_number_combo:true,letter_number_char_combo:true},validationRules:{length:function(e,t){digitalspaghetti.password.tooShort=false;var n=e.length;var r=Math.pow(n,digitalspaghetti.password.options.raisePower);if(n<digitalspaghetti.password.options.minChar){r=r-100;digitalspaghetti.password.tooShort=true}return r},lowercase:function(e,t){return e.match(/[a-z]/)&&t},uppercase:function(e,t){return e.match(/[A-Z]/)&&t},one_number:function(e,t){return e.match(/\d+/)&&t},three_numbers:function(e,t){return e.match(/(.*[0-9].*[0-9].*[0-9])/)&&t},one_special_char:function(e,t){return e.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&t},two_special_char:function(e,t){return e.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&t},upper_lower_combo:function(e,t){return e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&t},letter_number_combo:function(e,t){return e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&t},letter_number_char_combo:function(e,t){return e.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&t}},attachWidget:function(e){var t=['<div id="password-strength">'];if(digitalspaghetti.password.options.displayMinChar&&!digitalspaghetti.password.tooShort){t.push('<span class="password-min-char">'+digitalspaghetti.password.options.minCharText.replace("%d",digitalspaghetti.password.options.minChar)+"</span>")}t.push('<span class="password-strength-bar"></span>');t.push("</div>");t=t.join("");jQuery(e).after(t)},debugOutput:function(e){if(typeof console.log==="function"){console.log(digitalspaghetti.password)}else{alert(digitalspaghetti.password)}},addRule:function(e,t,n,r){digitalspaghetti.password.rules[e]=r;digitalspaghetti.password.ruleScores[e]=n;digitalspaghetti.password.validationRules[e]=t;return true},init:function(e,t){digitalspaghetti.password.options=jQuery.extend({},digitalspaghetti.password.defaults,t);digitalspaghetti.password.attachWidget(e);jQuery(e).keyup(function(){digitalspaghetti.password.calculateScore(this,jQuery(this).val())});if(digitalspaghetti.password.options.debug){digitalspaghetti.password.debugOutput()}},calculateScore:function(e,t){digitalspaghetti.password.totalscore=0;digitalspaghetti.password.width=0;for(var n in digitalspaghetti.password.rules)if(digitalspaghetti.password.rules.hasOwnProperty(n)){if(digitalspaghetti.password.rules[n]===true){var r=digitalspaghetti.password.ruleScores[n];var i=digitalspaghetti.password.validationRules[n](t,r);if(i){digitalspaghetti.password.totalscore+=i}}if(digitalspaghetti.password.totalscore<=digitalspaghetti.password.options.scores[0]){digitalspaghetti.password.strColor=digitalspaghetti.password.options.colors[0];digitalspaghetti.password.strText=digitalspaghetti.password.options.verdicts[0];digitalspaghetti.password.width="1"}else if(digitalspaghetti.password.totalscore>digitalspaghetti.password.options.scores[0]&&digitalspaghetti.password.totalscore<=digitalspaghetti.password.options.scores[1]){digitalspaghetti.password.strColor=digitalspaghetti.password.options.colors[1];digitalspaghetti.password.strText=digitalspaghetti.password.options.verdicts[1];digitalspaghetti.password.width="25"}else if(digitalspaghetti.password.totalscore>digitalspaghetti.password.options.scores[1]&&digitalspaghetti.password.totalscore<=digitalspaghetti.password.options.scores[2]){digitalspaghetti.password.strColor=digitalspaghetti.password.options.colors[2];digitalspaghetti.password.strText=digitalspaghetti.password.options.verdicts[2];digitalspaghetti.password.width="50"}else if(digitalspaghetti.password.totalscore>digitalspaghetti.password.options.scores[2]&&digitalspaghetti.password.totalscore<=digitalspaghetti.password.options.scores[3]){digitalspaghetti.password.strColor=digitalspaghetti.password.options.colors[3];digitalspaghetti.password.strText=digitalspaghetti.password.options.verdicts[3];digitalspaghetti.password.width="75"}else{digitalspaghetti.password.strColor=digitalspaghetti.password.options.colors[4];digitalspaghetti.password.strText=digitalspaghetti.password.options.verdicts[4];digitalspaghetti.password.width="99"}jQuery(".password-strength-bar").stop();if(digitalspaghetti.password.options.displayMinChar&&!digitalspaghetti.password.tooShort){jQuery(".password-min-char").hide()}else{jQuery(".password-min-char").show()}jQuery(".password-strength-bar").animate({opacity:.5},"fast","linear",function(){jQuery(this).css({display:"block","background-color":digitalspaghetti.password.strColor,width:digitalspaghetti.password.width+"%"}).text(digitalspaghetti.password.strText);jQuery(this).animate({opacity:1},"fast","linear")})}jQuery(e).removeClass("required-error");if(digitalspaghetti.password.width<digitalspaghetti.password.options.scores[3]){jQuery(e).addClass("required-error")}}};jQuery.extend(jQuery.fn,{pstrength:function(e){return this.each(function(){digitalspaghetti.password.init(this,e)})}});jQuery.extend(jQuery.fn.pstrength,{addRule:function(e,t,n,r){digitalspaghetti.password.addRule(e,t,n,r);return true},changeScore:function(e,t){digitalspaghetti.password.ruleScores[e]=t;return true},ruleActive:function(e,t){digitalspaghetti.password.rules[e]=t;return true}})