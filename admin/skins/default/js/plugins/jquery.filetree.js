function in_array(e,t,n){if(n){function r(e,t){return e===t}}else{function r(e,t){return e==t}}for(var i in t){if(r(t[i],e))return true}return false}function array_search(e,t,n){var n=!!n;for(var r in t){if(n&&t[r]===e||!n&&t[r]==e){return true}}return false}if(jQuery)(function(e){var t="skins/"+e("#val_skin_folder").text()+"/images/";if(e("#val_admin_folder").length){t=e("#val_admin_folder").text()+"/"+t}else if(e("#val_store_url").length){t=e("#val_store_url").text()+"/"+t}if(e("#val_skin_common_images").length){t=t+e("#val_skin_common_images").text()+"/"}e.extend(e.fn,{fileTree:function(n,r){if(!n)var n={};if(!r)var r=function(e){return};if(!n.root)n.root="/";if(!n.name)n.name="image";if(!n.group)n.group=1;if(!n.script)n.script=e("#val_admin_file").text();if(!n.unique){n.unique=e(this).hasClass("unique")?true:false}e(this).each(function(){function r(r,s){e(r).addClass("wait");e(".filetree.start").remove();if(e(r).children("ul").length>=1){e(r).removeClass("wait").children("ul").slideDown()}else{e.ajax({complete:function(t,n){e(".wait").removeClass("wait")},dataType:"json",global:false});e.getJSON(n.script,{_g:"xml",type:"files",q:"list",dir:s,group:n.group},function(u){e(r).find(".start").html("");var a=document.createElement("ul");e(a).addClass("filetree");e.each(u,function(r,i){var s=document.createElement("li");var u=document.createElement("a");switch(i.type){case"directory":e(s).addClass("directory collapsed");e(u).attr({href:"#",rel:i.path}).text(i.name);break;case"file":var f=document.createElement("span");var l=document.createElement("img");var c="0";if(typeof file_default!="number")file_default=0;if(file_default==i.id){var h="2"}else{var h=typeof file_list=="object"&&array_search(i.id,file_list)?1:0}e(f).addClass("actions");e(l).addClass("imgtoggle").data({id:n.name+"_"+i.id,rel:i.id,name:n.name+"["+i.id+"]",value:h});switch(h){case"2":c="star";break;default:c=h}l.src=t+c+".png";e(l).attr({rel:"#"+n.name+"_"+i.id}).addClass("checkbox");if(n.unique)e(l).addClass("unique");e(f).append(l);e(s).append(f).addClass("file");e(u).attr({href:i.path+i.name,rel:i.path,title:i.description}).text(i.file);if(i.mime.match(/^image/)){e(s).addClass("image");e(u).bind("click",function(){e.fn.colorbox({href:e(u).attr("href"),open:true});return false})}break}e(s).append(u);e(a).append(s)});if(n.root==s)e(r).find("ul:hidden").show();else e(r).find("ul:hidden").slideDown("slow");e(r).append(a).removeClass("wait");i(r)})}}function i(t){e(t).find("li>a").bind("click",function(){if(e(this).parent().hasClass("directory")){if(e(this).parent().hasClass("collapsed")){e(this).parent("ul").remove();r(e(this).parent(),e(this).attr("rel"));e(this).parent().removeClass("collapsed").addClass("expanded")}else{e(this).parent().find("ul").slideUp("slow");e(this).parent().removeClass("expanded").addClass("collapsed")}}return false})}e(this).html('<ul class="filetree start"><li class="wait">&nbsp;<li></ul>');r(e(this),escape(n.root))})}});e("input.toggle:hidden").each(function(){var n=e(this).val()=="1"?"1":"0";var r=document.createElement("img");r.src=t+n+".png";if(n=="1"){r.alt=r.title="Disable"}else{r.alt=r.title="Enable"}e(r).addClass("checkbox");if(e(this).hasClass("unique"))e(r).addClass("unique");e(r).attr("rel","#"+e(this).attr("id"));e(this).after(r)}).change(function(){switch(e(this).val()){case"1":var n="1";var r="Disable";break;case"2":var n="star";var r="";break;default:var n="0";var r="Enable";break}var i="img.checkbox[rel=#"+e(this).attr("id")+"]";e(i).attr({src:t+n+".png",alt:r,title:r})});e("#content_body").on("click","img.imgtoggle",function(){var n=e(this).data("id");var r=e(this).hasClass("unique");var i=document.createElement("input");var s="0";if(r)e(i).addClass("unique");e(i).addClass("toggle").attr({type:"hidden",id:n,rel:e(this).data("rel"),name:e(this).data("name"),value:e(this).data("value")}).change(function(){switch(e(this).val()){case"1":s="1";break;case"2":s="star";if(e("#master_image_preview").exists()){var r=e(this).closest(".image").find("a").attr("href");e("#master_image_preview").attr("src",r)}break;default:s="0";break}var i="img.checkbox[rel=#"+n+"]";e(i).attr({src:t+s+".png"})});var o=e(this).parent("span.action");e(this).before(i);e(this).removeClass("imgtoggle").addClass("toggle")});e("#content_body").on("click","img.checkbox",function(){var t=e(this).attr("rel");var n=e(this).parents("div:first").hasClass("fm-filelist");var r=e(this).hasClass("unique");switch(e(t).val()){case"1":if(r||!n){var i="0"}else{e("input[value=2].toggle").each(function(){e("img[rel="+e(this).attr("rel")+"].checkbox").val("1").change()});var i="2"}break;case"2":var i="0";break;default:if(r)e(".fm-container input.toggle").val("0").change();var i="1";break}e(t).val(i).change()})})(jQuery)