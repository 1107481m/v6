jQuery.fn.cropper=function(){this.each(function(){var e=new Image;var t=jQuery(this).attr("id");e.src=jQuery(this).attr("src");var n=document.createElement("div");jQuery(n).addClass("crop_wrapper").css({width:e.width,height:e.height});var r=document.createElement("input");jQuery(r).attr({id:t+"_x",name:t+"[x]",type:"hidden"});jQuery(n).append(r);var i=document.createElement("input");jQuery(i).attr({id:t+"_y",name:t+"[y]",type:"hidden"});jQuery(n).append(i);var s=document.createElement("input");jQuery(s).attr({id:t+"_h",name:t+"[h]",type:"hidden"});jQuery(n).append(s);var o=document.createElement("input");jQuery(o).attr({id:t+"_w",name:t+"[w]",type:"hidden"});jQuery(n).append(o);var u=document.createElement("div");jQuery(u).addClass("crop_source").css({width:e.width,height:e.height,background:"transparent url("+e.src+") no-repeat scroll 0%",opacity:.3});var a=document.createElement("div");jQuery(a).addClass("crop_select").resizable({containment:"parent",handles:"all",knobHandles:true,ghost:false,autoHide:false,minWidth:75,minHeight:75,resize:function(e,t){var n=jQuery(this).data("resizable");this.style.backgroundPosition="-"+n.position.left+"px -"+n.position.top+"px";jQuery(r).val(n.position.left);jQuery(i).val(n.position.top);jQuery(s).val(n.size.height);jQuery(o).val(n.size.width)},stop:function(e,t){var n=jQuery(this).data("resizable");this.style.backgroundPosition="-"+n.position.left+"px -"+n.position.top+"px"}}).draggable({cursor:"move",containment:"parent",drag:function(e,t){var n=jQuery(this).data("draggable");jQuery(r).val(n.position.left);jQuery(i).val(n.position.top);this.style.backgroundPosition="-"+n.position.left+"px -"+n.position.top+"px"}}).css({background:"transparent url("+e.src+") no-repeat scroll 0px 0px"});jQuery(n).append(u);jQuery(n).append(a);jQuery(this).replaceWith(n)})};jQuery(document).ready(function(){jQuery("img.cropper").cropper()})